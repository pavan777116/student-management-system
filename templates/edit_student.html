<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Edit Student</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="running-banner">
<span>Student Management System.  </span>
</div>

<div class="flash-messages">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
        <div class="alert {{ category }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
    {% endwith %}
</div>

<div class="edit-student-container">
    <div class="header">
        <h1>Edit Student Details</h1>
    </div>
    <div class="edit-form-card">
        <h2>{{ student.name }} ({{ student.reg_no }})</h2>
        <form action="{{ url_for('edit_student', student_id=student.id) }}" method="post">
            <div class="form-group">
                <label for="attendance">Attendance (%)</label>
                <input type="number" id="attendance" name="attendance" value="{{ student.attendance }}" min="0" max="100" required>
            </div>
            <div class="form-group">
                <label for="cgpa">CGPA</label>
                <input type="number" step="0.01" id="cgpa" name="cgpa" value="{{ student.cgpa }}" required>
            </div>

            <h3>Subject Marks (out of 100)</h3>
            <div class="marks-grid">
                {% for i in range(6) %}
                <div class="marks-input-group">
                    <label for="subject_code_{{ loop.index }}">Subject {{ loop.index }} Code:</label>
                    <input type="text" id="subject_code_{{ loop.index }}" name="subject_code_{{ loop.index }}" value="{{ existing_marks[loop.index0].code if existing_marks|length > loop.index0 }}" placeholder="e.g., CSE101" required>
                    <label for="score_{{ loop.index }}">Score:</label>
                    <input type="number" id="score_{{ loop.index }}" name="score_{{ loop.index }}" value="{{ existing_marks[loop.index0].score if existing_marks|length > loop.index0 }}" min="0" max="100" required>
                </div>
                {% endfor %}
            </div>

            <button type="submit" class="btn">Update Details</button>
        </form>
        <div class="footer-link">
            <a href="{{ url_for('admin_dashboard') }}">Back to Dashboard</a>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const flashMessages = document.querySelectorAll('.alert');
        flashMessages.forEach(function(message) {
            setTimeout(function() {
                message.style.transition = 'opacity 0.5s ease-in-out';
                message.style.opacity = '0';
                setTimeout(function() {
                    message.remove();
                }, 500); // Wait for the fade out transition to complete
            }, 3000); // 3 seconds before the fade out starts
        });
    });
</script>
</body>
</html>